<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>OSSL_PROVIDER</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<ul>

		<li><a href="#functions">Functions</a></li>
	</ul>

	<li><a href="#return_values">RETURN VALUES</a></li>
	<li><a href="#examples">EXAMPLES</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#history">HISTORY</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>OSSL_PROVIDER_set_default_search_path,
OSSL_PROVIDER, OSSL_PROVIDER_load, OSSL_PROVIDER_try_load, OSSL_PROVIDER_unload,
OSSL_PROVIDER_available, OSSL_PROVIDER_do_all,
OSSL_PROVIDER_gettable_params, OSSL_PROVIDER_get_params,
OSSL_PROVIDER_query_operation, OSSL_PROVIDER_unquery_operation,
OSSL_PROVIDER_get0_provider_ctx, OSSL_PROVIDER_get0_dispatch,
OSSL_PROVIDER_add_builtin, OSSL_PROVIDER_get0_name, OSSL_PROVIDER_get_capabilities,
OSSL_PROVIDER_self_test
- provider routines</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
 <span class="comment">#include &lt;openssl/provider.h&gt;</span>
</pre>
<pre>
 <span class="variable">typedef</span> <span class="variable">struct</span> <span class="variable">ossl_provider_st</span> <span class="variable">OSSL_PROVIDER</span><span class="operator">;</span>
</pre>
<pre>
 <span class="keyword">int</span> <span class="variable">OSSL_PROVIDER_set_default_search_path</span><span class="operator">(</span><span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span>
                                           <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*path</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">OSSL_PROVIDER</span> <span class="variable">*OSSL_PROVIDER_load</span><span class="operator">(</span><span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*name</span><span class="operator">);</span>
 <span class="variable">OSSL_PROVIDER</span> <span class="variable">*OSSL_PROVIDER_try_load</span><span class="operator">(</span><span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*name</span><span class="operator">,</span>
                                       <span class="keyword">int</span> <span class="variable">retain_fallbacks</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_PROVIDER_unload</span><span class="operator">(</span><span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_PROVIDER_available</span><span class="operator">(</span><span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*name</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_PROVIDER_do_all</span><span class="operator">(</span><span class="variable">OSSL_LIB_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span>
                          <span class="keyword">int</span> <span class="operator">(</span><span class="variable">*cb</span><span class="operator">)(</span><span class="variable">OSSL_PROVIDER</span> <span class="variable">*provider</span><span class="operator">,</span> <span class="variable">void</span> <span class="variable">*cbdata</span><span class="operator">),</span>
                          <span class="variable">void</span> <span class="variable">*cbdata</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">const</span> <span class="variable">OSSL_PARAM</span> <span class="variable">*OSSL_PROVIDER_gettable_params</span><span class="operator">(</span><span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_PROVIDER_get_params</span><span class="operator">(</span><span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">,</span> <span class="variable">OSSL_PARAM</span> <span class="variable">params</span><span class="operator">[]</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">const</span> <span class="variable">OSSL_ALGORITHM</span> <span class="variable">*OSSL_PROVIDER_query_operation</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">,</span>
                                                     <span class="keyword">int</span> <span class="variable">operation_id</span><span class="operator">,</span>
                                                     <span class="keyword">int</span> <span class="variable">*no_cache</span><span class="operator">);</span>
 <span class="variable">void</span> <span class="variable">OSSL_PROVIDER_unquery_operation</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">,</span>
                                      <span class="keyword">int</span> <span class="variable">operation_id</span><span class="operator">,</span>
                                      <span class="variable">const</span> <span class="variable">OSSL_ALGORITHM</span> <span class="variable">*algs</span><span class="operator">);</span>
 <span class="variable">void</span> <span class="variable">*OSSL_PROVIDER_get0_provider_ctx</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">);</span>
 <span class="variable">const</span> <span class="variable">OSSL_DISPATCH</span> <span class="variable">*OSSL_PROVIDER_get0_dispatch</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">);</span>
</pre>
<pre>
 <span class="keyword">int</span> <span class="variable">OSSL_PROVIDER_add_builtin</span><span class="operator">(</span><span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*name</span><span class="operator">,</span>
                               <span class="variable">ossl_provider_init_fn</span> <span class="variable">*init_fn</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*OSSL_PROVIDER_get0_name</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">);</span>
</pre>
<pre>
 <span class="keyword">int</span> <span class="variable">OSSL_PROVIDER_get_capabilities</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">,</span>
                                    <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*capability</span><span class="operator">,</span>
                                    <span class="variable">OSSL_CALLBACK</span> <span class="variable">*cb</span><span class="operator">,</span>
                                    <span class="variable">void</span> <span class="variable">*arg</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_PROVIDER_self_test</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span><span class="operator">);</span>
</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p><strong>OSSL_PROVIDER</strong> is a type that holds internal information about
implementation providers (see <em>provider(7)</em> for information on what a
provider is).
A provider can be built in to the application or the OpenSSL
libraries, or can be a loadable module.
The functions described here handle both forms.</p>
<p>Some of these functions operate within a library context, please see
<em>OSSL_LIB_CTX(3)</em> for further details.</p>
<p>
</p>
<h2><a name="functions">Functions</a></h2>
<p><code>OSSL_PROVIDER_set_default_search_path()</code> specifies the default search <em>path</em>
that is to be used for looking for providers in the specified <em>libctx</em>.
If left unspecified, an environment variable and a fall back default value will
be used instead.</p>
<p><code>OSSL_PROVIDER_add_builtin()</code> is used to add a built in provider to
<strong>OSSL_PROVIDER</strong> store in the given library context, by associating a
provider name with a provider initialization function.
This name can then be used with <code>OSSL_PROVIDER_load()</code>.</p>
<p><code>OSSL_PROVIDER_load()</code> loads and initializes a provider.
This may simply initialize a provider that was previously added with
<code>OSSL_PROVIDER_add_builtin()</code> and run its given initialization function,
or load a provider module with the given name and run its provider
entry point, <code>OSSL_provider_init</code>. The <em>name</em> can be a path
to a provider module, in that case the provider name as returned
by OSSL_PROVIDER_get0_name() will be the path. Interpretation
of relative paths is platform dependent and they are relative
to the configured &quot;MODULESDIR&quot; directory or the path set in
the environment variable OPENSSL_MODULES if set.</p>
<p><code>OSSL_PROVIDER_try_load()</code> functions like <code>OSSL_PROVIDER_load()</code>, except that
it does not disable the fallback providers if the provider cannot be
loaded and initialized or if <em>retain_fallbacks</em> is nonzero.
If the provider loads successfully and <em>retain_fallbacks</em> is zero, the
fallback providers are disabled.</p>
<p><code>OSSL_PROVIDER_unload()</code> unloads the given provider.
For a provider added with <code>OSSL_PROVIDER_add_builtin()</code>, this simply
runs its teardown function.</p>
<p><code>OSSL_PROVIDER_available()</code> checks if a named provider is available
for use.</p>
<p><code>OSSL_PROVIDER_do_all()</code> iterates over all loaded providers, calling
<em>cb</em> for each one, with the current provider in <em>provider</em> and the
<em>cbdata</em> that comes from the caller. If no other provider has been loaded
before calling this function, the default provider is still available as
fallback.
See <em>OSSL_PROVIDER-default(7)</em> for more information on this fallback
behaviour.</p>
<p><code>OSSL_PROVIDER_gettable_params()</code> is used to get a provider parameter
descriptor set as a constant <em>OSSL_PARAM(3)</em> array.</p>
<p><code>OSSL_PROVIDER_get_params()</code> is used to get provider parameter values.
The caller must prepare the <em>OSSL_PARAM(3)</em> array before calling this
function, and the variables acting as buffers for this parameter array
should be filled with data when it returns successfully.</p>
<p><code>OSSL_PROVIDER_self_test()</code> is used to run a provider's self tests on demand.
If the self tests fail then the provider will fail to provide any further
services and algorithms. <em>OSSL_SELF_TEST_set_callback(3)</em> may be called
beforehand in order to display diagnostics for the running self tests.</p>
<p><code>OSSL_PROVIDER_query_operation()</code> calls the provider's <em>query_operation</em>
function (see <em>provider(7)</em>), if the provider has one. It returns an
array of <em>OSSL_ALGORITHM</em> for the given <em>operation_id</em> terminated by an all
NULL OSSL_ALGORITHM entry. This is considered a low-level function that most
applications should not need to call.</p>
<p><code>OSSL_PROVIDER_unquery_operation()</code> calls the provider's <em>unquery_operation</em>
function (see <em>provider(7)</em>), if the provider has one.  This is considered a
low-level function that most applications should not need to call.</p>
<p>OSSL_PROVIDER_get0_provider_ctx() returns the provider context for the given
provider. The provider context is an opaque handle set by the provider itself
and is passed back to the provider by libcrypto in various function calls.</p>
<p>OSSL_PROVIDER_get0_dispatch() returns the provider's dispatch table as it was
returned in the <em>out</em> parameter from the provider's init function. See
<em>provider-base(7)</em>.</p>
<p>If it is permissible to cache references to this array then <em>*no_store</em> is set
to 0 or 1 otherwise. If the array is not cacheable then it is assumed to
have a short lifetime.</p>
<p>OSSL_PROVIDER_get0_name() returns the name of the given provider.</p>
<p><code>OSSL_PROVIDER_get_capabilities()</code> provides information about the capabilities
supported by the provider specified in <em>prov</em> with the capability name
<em>capability</em>. For each capability of that name supported by the provider it
will call the callback <em>cb</em> and supply a set of <em>OSSL_PARAM(3)</em>s describing the
capability. It will also pass back the argument <em>arg</em>. For more details about
capabilities and what they can be used for please see
<em>provider-base(7)/CAPABILTIIES</em>.</p>
<p>
</p>
<hr />
<h1><a name="return_values">RETURN VALUES</a></h1>
<p><code>OSSL_PROVIDER_set_default_search_path()</code>, <code>OSSL_PROVIDER_add()</code>,
<code>OSSL_PROVIDER_unload()</code>, <code>OSSL_PROVIDER_get_params()</code> and
<code>OSSL_PROVIDER_get_capabilities()</code> return 1 on success, or 0 on error.</p>
<p><code>OSSL_PROVIDER_load()</code> and <code>OSSL_PROVIDER_try_load()</code> return a pointer to a
provider object on success, or NULL on error.</p>
<p><code>OSSL_PROVIDER_do_all()</code> returns 1 if the callback <em>cb</em> returns 1 for every
provider it is called with, or 0 if any provider callback invocation returns 0;
callback processing stops at the first callback invocation on a provider
that returns 0.</p>
<p><code>OSSL_PROVIDER_available()</code> returns 1 if the named provider is available,
otherwise 0.</p>
<p><code>OSSL_PROVIDER_gettable_params()</code> returns a pointer to an array
of constant <em>OSSL_PARAM(3)</em>, or NULL if none is provided.</p>
<p><code>OSSL_PROVIDER_get_params()</code> and returns 1 on success, or 0 on error.</p>
<p><code>OSSL_PROVIDER_query_operation()</code> returns an array of OSSL_ALGORITHM or NULL on
error.</p>
<p><code>OSSL_PROVIDER_self_test()</code> returns 1 if the self tests pass, or 0 on error.</p>
<p>
</p>
<hr />
<h1><a name="examples">EXAMPLES</a></h1>
<p>This demonstrates how to load the provider module &quot;foo&quot; and ask for
its build information.</p>
<pre>
 <span class="comment">#include &lt;openssl/params.h&gt;</span>
 <span class="comment">#include &lt;openssl/provider.h&gt;</span>
 <span class="comment">#include &lt;openssl/err.h&gt;</span>
</pre>
<pre>
 <span class="variable">OSSL_PROVIDER</span> <span class="variable">*prov</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
 <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*build</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
 <span class="variable">OSSL_PARAM</span> <span class="variable">request</span><span class="operator">[]</span> <span class="operator">=</span> <span class="operator">{</span>
     <span class="operator">{</span> <span class="string">"buildinfo"</span><span class="operator">,</span> <span class="variable">OSSL_PARAM_UTF8_PTR</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">build</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span> <span class="operator">}</span><span class="operator">,</span>
     <span class="operator">{</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span> <span class="operator">}</span>
 <span class="operator">}</span><span class="operator">;</span>
</pre>
<pre>
 <span class="keyword">if</span> <span class="operator">((</span><span class="variable">prov</span> <span class="operator">=</span> <span class="variable">OSSL_PROVIDER_load</span><span class="operator">(</span><span class="variable">NULL</span><span class="operator">,</span> <span class="string">"foo"</span><span class="operator">))</span> <span class="operator">!=</span> <span class="variable">NULL</span>
     <span class="operator">&amp;&amp;</span> <span class="variable">OSSL_PROVIDER_get_params</span><span class="operator">(</span><span class="variable">prov</span><span class="operator">,</span> <span class="variable">request</span><span class="operator">))</span>
     <span class="keyword">printf</span><span class="operator">(</span><span class="string">"Provider 'foo' buildinfo: %s\n"</span><span class="operator">,</span> <span class="variable">build</span><span class="operator">);</span>
 <span class="keyword">else</span>
     <span class="variable">ERR_print_errors_fp</span><span class="operator">(</span><span class="variable">stderr</span><span class="operator">);</span>
</pre>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><em>openssl-core.h(7)</em>, <em>OSSL_LIB_CTX(3)</em>, <em>provider(7)</em></p>
<p>
</p>
<hr />
<h1><a name="history">HISTORY</a></h1>
<p>The type and functions described here were added in OpenSSL 3.0.</p>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright 2019-2023 The OpenSSL Project Authors. All Rights Reserved.</p>
<p>Licensed under the Apache License 2.0 (the &quot;License&quot;).  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
<a href="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</a>.</p>

</body>

</html>
