<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>OSSL_ENCODER_CTX</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<ul>

		<li><a href="#functions">Functions</a></li>
		<li><a href="#constructor">Constructor</a></li>
	</ul>

	<li><a href="#return_values">RETURN VALUES</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#history">HISTORY</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>OSSL_ENCODER_CTX,
OSSL_ENCODER_CTX_new,
OSSL_ENCODER_settable_ctx_params,
OSSL_ENCODER_CTX_set_params,
OSSL_ENCODER_CTX_free,
OSSL_ENCODER_CTX_set_selection,
OSSL_ENCODER_CTX_set_output_type,
OSSL_ENCODER_CTX_set_output_structure,
OSSL_ENCODER_CTX_add_encoder,
OSSL_ENCODER_CTX_add_extra,
OSSL_ENCODER_CTX_get_num_encoders,
OSSL_ENCODER_INSTANCE,
OSSL_ENCODER_INSTANCE_get_encoder,
OSSL_ENCODER_INSTANCE_get_encoder_ctx,
OSSL_ENCODER_INSTANCE_get_output_type,
OSSL_ENCODER_INSTANCE_get_output_structure,
OSSL_ENCODER_CONSTRUCT,
OSSL_ENCODER_CLEANUP,
OSSL_ENCODER_CTX_set_construct,
OSSL_ENCODER_CTX_set_construct_data,
OSSL_ENCODER_CTX_set_cleanup
- Encoder context routines</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
 <span class="comment">#include &lt;openssl/encoder.h&gt;</span>
</pre>
<pre>
 <span class="variable">typedef</span> <span class="variable">struct</span> <span class="variable">ossl_encoder_ctx_st</span> <span class="variable">OSSL_ENCODER_CTX</span><span class="operator">;</span>
</pre>
<pre>
 <span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*OSSL_ENCODER_CTX_new</span><span class="operator">();</span>
 <span class="variable">const</span> <span class="variable">OSSL_PARAM</span> <span class="variable">*OSSL_ENCODER_settable_ctx_params</span><span class="operator">(</span><span class="variable">OSSL_ENCODER</span> <span class="variable">*encoder</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_set_params</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span>
                                 <span class="variable">const</span> <span class="variable">OSSL_PARAM</span> <span class="variable">params</span><span class="operator">[]</span><span class="operator">);</span>
 <span class="variable">void</span> <span class="variable">OSSL_ENCODER_CTX_free</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">);</span>
</pre>
<pre>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_set_selection</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span> <span class="keyword">int</span> <span class="variable">selection</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_set_output_type</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span>
                                      <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*output_type</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_set_output_structure</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span>
                                           <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*output_structure</span><span class="operator">);</span>
</pre>
<pre>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_add_encoder</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span> <span class="variable">OSSL_ENCODER</span> <span class="variable">*encoder</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_add_extra</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span>
                                <span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*propq</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_get_num_encoders</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">typedef</span> <span class="variable">struct</span> <span class="variable">ossl_encoder_instance_st</span> <span class="variable">OSSL_ENCODER_INSTANCE</span><span class="operator">;</span>
 <span class="variable">OSSL_ENCODER</span> <span class="operator">*</span>
 <span class="variable">OSSL_ENCODER_INSTANCE_get_encoder</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_INSTANCE</span> <span class="variable">*encoder_inst</span><span class="operator">);</span>
 <span class="variable">void</span> <span class="operator">*</span>
 <span class="variable">OSSL_ENCODER_INSTANCE_get_encoder_ctx</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_INSTANCE</span> <span class="variable">*encoder_inst</span><span class="operator">);</span>
 <span class="variable">const</span> <span class="variable">char</span> <span class="operator">*</span>
 <span class="variable">OSSL_ENCODER_INSTANCE_get_output_type</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_INSTANCE</span> <span class="variable">*encoder_inst</span><span class="operator">);</span>
 <span class="variable">const</span> <span class="variable">char</span> <span class="operator">*</span>
 <span class="variable">OSSL_ENCODER_INSTANCE_get_output_structure</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_INSTANCE</span> <span class="variable">*encoder_inst</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">typedef</span> <span class="variable">const</span> <span class="variable">void</span> <span class="variable">*OSSL_ENCODER_CONSTRUCT</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_INSTANCE</span> <span class="variable">*encoder_inst</span><span class="operator">,</span>
                                            <span class="variable">void</span> <span class="variable">*construct_data</span><span class="operator">);</span>
 <span class="variable">typedef</span> <span class="variable">void</span> <span class="variable">OSSL_ENCODER_CLEANUP</span><span class="operator">(</span><span class="variable">void</span> <span class="variable">*construct_data</span><span class="operator">);</span>
</pre>
<pre>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_set_construct</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span>
                                    <span class="variable">OSSL_ENCODER_CONSTRUCT</span> <span class="variable">*construct</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_set_construct_data</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span>
                                         <span class="variable">void</span> <span class="variable">*construct_data</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OSSL_ENCODER_CTX_set_cleanup</span><span class="operator">(</span><span class="variable">OSSL_ENCODER_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span>
                                  <span class="variable">OSSL_ENCODER_CLEANUP</span> <span class="variable">*cleanup</span><span class="operator">);</span>
</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>Encoding an input object to the desired encoding may be done with a chain of
encoder implementations, which means that the output from one encoder may be
the input for the next in the chain.  The <strong>OSSL_ENCODER_CTX</strong> holds all the
data about these encoders.  This allows having generic format encoders such
as DER to PEM, as well as more specialized encoders like RSA to DER.</p>
<p>The final output type must be given, and a chain of encoders must end with
an implementation that produces that output type.</p>
<p>At the beginning of the encoding process, a constructor provided by the
caller is called to ensure that there is an appropriate provider-side object
to start with.
The constructor is set with <code>OSSL_ENCODER_CTX_set_construct()</code>.</p>
<p><strong>OSSL_ENCODER_INSTANCE</strong> is an opaque structure that contains data about the
encoder that is going to be used, and that may be useful for the
constructor.  There are some functions to extract data from this type,
described in <a href="#constructor">Constructor</a> below.</p>
<p>
</p>
<h2><a name="functions">Functions</a></h2>
<p><code>OSSL_ENCODER_CTX_new()</code> creates a <strong>OSSL_ENCODER_CTX</strong>.</p>
<p><code>OSSL_ENCODER_settable_ctx_params()</code> returns an <em>OSSL_PARAM(3)</em>
array of parameter descriptors.</p>
<p><code>OSSL_ENCODER_CTX_set_params()</code> attempts to set parameters specified
with an <em>OSSL_PARAM(3)</em> array <em>params</em>.  Parameters that the
implementation doesn't recognise should be ignored.</p>
<p><code>OSSL_ENCODER_CTX_free()</code> frees the given context <em>ctx</em>.</p>
<p><code>OSSL_ENCODER_CTX_add_encoder()</code> populates the <strong>OSSL_ENCODER_CTX</strong>
<em>ctx</em> with a encoder, to be used to encode an input object.</p>
<p><code>OSSL_ENCODER_CTX_add_extra()</code> finds encoders that further encodes output
from already added encoders, and adds them as well.  This is used to build
encoder chains.</p>
<p><code>OSSL_ENCODER_CTX_set_output_type()</code> sets the ending output type.  This must
be specified, and determines if a complete encoder chain is available.</p>
<p><code>OSSL_ENCODER_CTX_set_output_structure()</code> sets the desired output structure.
This may be used to determines what encoder implementations may be used.
Depending on the type of object being encoded, the output structure may
not be relevant.</p>
<p><code>OSSL_ENCODER_CTX_get_num_encoders()</code> gets the number of encoders currently
added to the context <em>ctx</em>.</p>
<p><code>OSSL_ENCODER_CTX_set_construct()</code> sets the constructor <em>construct</em>.</p>
<p><code>OSSL_ENCODER_CTX_set_construct_data()</code> sets the constructor data that is
passed to the constructor every time it's called.</p>
<p><code>OSSL_ENCODER_CTX_set_cleanup()</code> sets the constructor data <em>cleanup</em>
function.  This is called by <em>OSSL_ENCODER_CTX_free(3)</em>.</p>
<p>
</p>
<h2><a name="constructor">Constructor</a></h2>
<p>A <strong>OSSL_ENCODER_CONSTRUCT</strong> gets the following arguments:</p>
<dl>
<dt><strong><a name="encoder_inst" class="item"><em>encoder_inst</em></a></strong></dt>

<dd>
<p>The <strong>OSSL_ENCODER_INSTANCE</strong> for the encoder from which the constructor gets
its data.</p>
</dd>
<dt><strong><a name="construct_data" class="item"><em>construct_data</em></a></strong></dt>

<dd>
<p>The pointer that was set with <code>OSSL_ENCODE_CTX_set_construct_data()</code>.</p>
</dd>
</dl>
<p>The constructor is expected to return a valid (non-NULL) pointer to a
provider-native object that can be used as first input of an encoding chain,
or NULL to indicate that an error has occurred.</p>
<p>These utility functions may be used by a constructor:</p>
<p><code>OSSL_ENCODER_INSTANCE_get_encoder()</code> can be used to get the encoder
implementation of the encoder instance <em>encoder_inst</em>.</p>
<p><code>OSSL_ENCODER_INSTANCE_get_encoder_ctx()</code> can be used to get the encoder
implementation's provider context of the encoder instance <em>encoder_inst</em>.</p>
<p><code>OSSL_ENCODER_INSTANCE_get_output_type()</code> can be used to get the output type
for the encoder implementation of the encoder instance <em>encoder_inst</em>.
This will never be NULL.</p>
<p><code>OSSL_ENCODER_INSTANCE_get_output_structure()</code> can be used to get the output
structure for the encoder implementation of the encoder instance
<em>encoder_inst</em>.
This may be NULL.</p>
<p>
</p>
<hr />
<h1><a name="return_values">RETURN VALUES</a></h1>
<p><code>OSSL_ENCODER_CTX_new()</code> returns a pointer to a <strong>OSSL_ENCODER_CTX</strong>, or NULL
if the context structure couldn't be allocated.</p>
<p><code>OSSL_ENCODER_settable_ctx_params()</code> returns an <em>OSSL_PARAM(3)</em> array, or
NULL if none is available.</p>
<p><code>OSSL_ENCODER_CTX_set_params()</code> returns 1 if all recognised parameters were
valid, or 0 if one of them was invalid or caused some other failure in the
implementation.</p>
<p><code>OSSL_ENCODER_CTX_add_encoder()</code>, <code>OSSL_ENCODER_CTX_add_extra()</code>,
<code>OSSL_ENCODER_CTX_set_construct()</code>, <code>OSSL_ENCODER_CTX_set_construct_data()</code> and
<code>OSSL_ENCODER_CTX_set_cleanup()</code> return 1 on success, or 0 on failure.</p>
<p><code>OSSL_ENCODER_CTX_get_num_encoders()</code> returns the current number of encoders.
It returns 0 if <em>ctx</em> is NULL.</p>
<p><code>OSSL_ENCODER_INSTANCE_get_encoder()</code> returns an <strong>OSSL_ENCODER</strong> pointer on
success, or NULL on failure.</p>
<p><code>OSSL_ENCODER_INSTANCE_get_encoder_ctx()</code> returns a provider context pointer on
success, or NULL on failure.</p>
<p><code>OSSL_ENCODER_INSTANCE_get_output_type()</code> returns a string with the name of the
input type, if relevant.  NULL is a valid returned value.</p>
<p><code>OSSL_ENCODER_INSTANCE_get_output_type()</code> returns a string with the name of the
output type.</p>
<p><code>OSSL_ENCODER_INSTANCE_get_output_structure()</code> returns a string with the name
of the output structure.</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><em>provider(7)</em>, <em>OSSL_ENCODER(3)</em></p>
<p>
</p>
<hr />
<h1><a name="history">HISTORY</a></h1>
<p>The functions described here were added in OpenSSL 3.0.</p>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright 2019-2023 The OpenSSL Project Authors. All Rights Reserved.</p>
<p>Licensed under the Apache License 2.0 (the &quot;License&quot;).  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
<a href="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</a>.</p>

</body>

</html>
