<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>SRP_create_verifier</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#return_values">RETURN VALUES</a></li>
	<li><a href="#examples">EXAMPLES</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#history">HISTORY</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>SRP_create_verifier_ex,
SRP_create_verifier,
SRP_create_verifier_BN_ex,
SRP_create_verifier_BN,
SRP_check_known_gN_param,
SRP_get_default_gN
- SRP authentication primitives</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
 <span class="comment">#include &lt;openssl/srp.h&gt;</span>
</pre>
<p>The following functions have been deprecated since OpenSSL 3.0, and can be
hidden entirely by defining <strong>OPENSSL_API_COMPAT</strong> with a suitable version value,
see <em>openssl_user_macros(7)</em>:</p>
<pre>
 <span class="keyword">int</span> <span class="variable">SRP_create_verifier_BN_ex</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">char</span> <span class="variable">*user</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*pass</span><span class="operator">,</span> <span class="variable">BIGNUM</span> <span class="operator">**</span><span class="variable">salt</span><span class="operator">,</span>
                               <span class="variable">BIGNUM</span> <span class="operator">**</span><span class="variable">verifier</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">BIGNUM</span> <span class="variable">*N</span><span class="operator">,</span>
                               <span class="variable">const</span> <span class="variable">BIGNUM</span> <span class="variable">*g</span><span class="operator">,</span> <span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span>
                               <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*propq</span><span class="operator">);</span>
 <span class="variable">char</span> <span class="variable">*SRP_create_verifier_BN</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">char</span> <span class="variable">*user</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*pass</span><span class="operator">,</span> <span class="variable">BIGNUM</span> <span class="operator">**</span><span class="variable">salt</span><span class="operator">,</span>
                              <span class="variable">BIGNUM</span> <span class="operator">**</span><span class="variable">verifier</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">BIGNUM</span> <span class="variable">*N</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">BIGNUM</span> <span class="variable">*g</span><span class="operator">);</span>
 <span class="variable">char</span> <span class="variable">*SRP_create_verifier_ex</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">char</span> <span class="variable">*user</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*pass</span><span class="operator">,</span> <span class="variable">char</span> <span class="operator">**</span><span class="variable">salt</span><span class="operator">,</span>
                              <span class="variable">char</span> <span class="operator">**</span><span class="variable">verifier</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*N</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*g</span><span class="operator">,</span>
                              <span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*propq</span><span class="operator">);</span>
 <span class="variable">char</span> <span class="variable">*SRP_create_verifier</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">char</span> <span class="variable">*user</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*pass</span><span class="operator">,</span> <span class="variable">char</span> <span class="operator">**</span><span class="variable">salt</span><span class="operator">,</span>
                           <span class="variable">char</span> <span class="operator">**</span><span class="variable">verifier</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*N</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*g</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">char</span> <span class="variable">*SRP_check_known_gN_param</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">BIGNUM</span> <span class="variable">*g</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">BIGNUM</span> <span class="variable">*N</span><span class="operator">);</span>
 <span class="variable">SRP_gN</span> <span class="variable">*SRP_get_default_gN</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">char</span> <span class="variable">*id</span><span class="operator">);</span>
</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>All of the functions described on this page are deprecated. There are no
available replacement functions at this time.</p>
<p>The <code>SRP_create_verifier_BN_ex()</code> function creates an SRP password verifier from
the supplied parameters as defined in section 2.4 of <a href="http://www.ietf.org/rfc/rfc5054.txt" class="rfc">RFC 5054</a> using the library
context <em>libctx</em> and property query string <em>propq</em>. Any cryptographic
algorithms that need to be fetched will use the <em>libctx</em> and <em>propq</em>. See
<em>crypto(7)/ALGORITHM FETCHING</em>.</p>
<p><code>SRP_create_verifier_BN()</code> is the same as <code>SRP_create_verifier_BN_ex()</code> except the
default library context and property query string is used.</p>
<p>On successful exit <em>*verifier</em> will point to a newly allocated BIGNUM containing
the verifier and (if a salt was not provided) <em>*salt</em> will be populated with a
newly allocated BIGNUM containing a random salt. If <em>*salt</em> is not NULL then
the provided salt is used instead.
The caller is responsible for freeing the allocated <em>*salt</em> and <em>*verifier</em>
BIGNUMS (use <em>BN_free(3)</em>).</p>
<p>The <code>SRP_create_verifier()</code> function is similar to <code>SRP_create_verifier_BN()</code> but
all numeric parameters are in a non-standard base64 encoding originally designed
for compatibility with libsrp. This is mainly present for historical compatibility
and its use is discouraged.
It is possible to pass NULL as <em>N</em> and an SRP group id as <em>g</em> instead to
load the appropriate gN values (see SRP_get_default_gN()).
If both <em>N</em> and <em>g</em> are NULL the 8192-bit SRP group parameters are used.
The caller is responsible for freeing the allocated <em>*salt</em> and <em>*verifier</em>
(use <em>OPENSSL_free(3)</em>).</p>
<p>The <code>SRP_check_known_gN_param()</code> function checks that <em>g</em> and <em>N</em> are valid
SRP group parameters from <a href="http://www.ietf.org/rfc/rfc5054.txt" class="rfc">RFC 5054</a> appendix A.</p>
<p>The <code>SRP_get_default_gN()</code> function returns the gN parameters for the <a href="http://www.ietf.org/rfc/rfc5054.txt" class="rfc">RFC 5054</a> <em>id</em>
SRP group size.
The known ids are &quot;1024&quot;, &quot;1536&quot;, &quot;2048&quot;, &quot;3072&quot;, &quot;4096&quot;, &quot;6144&quot; and &quot;8192&quot;.</p>
<p>
</p>
<hr />
<h1><a name="return_values">RETURN VALUES</a></h1>
<p><code>SRP_create_verifier_BN_ex()</code> and <code>SRP_create_verifier_BN()</code> return 1 on success and
0 on failure.</p>
<p><code>SRP_create_verifier_ex()</code> and <code>SRP_create_verifier()</code> return NULL on failure and a
non-NULL value on success:
&quot;*&quot; if <em>N</em> is not NULL, the selected group id otherwise. This value should
not be freed.</p>
<p><code>SRP_check_known_gN_param()</code> returns the text representation of the group id
(i.e. the prime bit size) or NULL if the arguments are not valid SRP group parameters.
This value should not be freed.</p>
<p><code>SRP_get_default_gN()</code> returns NULL if <em>id</em> is not a valid group size,
or the 8192-bit group parameters if <em>id</em> is NULL.</p>
<p>
</p>
<hr />
<h1><a name="examples">EXAMPLES</a></h1>
<p>Generate and store a 8192 bit password verifier (error handling
omitted for clarity):</p>
<pre>
 <span class="comment">#include &lt;openssl/bn.h&gt;</span>
 <span class="comment">#include &lt;openssl/srp.h&gt;</span>
</pre>
<pre>
 <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*username</span> <span class="operator">=</span> <span class="string">"username"</span><span class="operator">;</span>
 <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*password</span> <span class="operator">=</span> <span class="string">"password"</span><span class="operator">;</span>
</pre>
<pre>
 <span class="variable">SRP_VBASE</span> <span class="variable">*srpData</span> <span class="operator">=</span> <span class="variable">SRP_VBASE_new</span><span class="operator">(</span><span class="variable">NULL</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">SRP_gN</span> <span class="variable">*gN</span> <span class="operator">=</span> <span class="variable">SRP_get_default_gN</span><span class="operator">(</span><span class="string">"8192"</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">BIGNUM</span> <span class="variable">*salt</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">*verifier</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
 <span class="variable">SRP_create_verifier_BN_ex</span><span class="operator">(</span><span class="variable">username</span><span class="operator">,</span> <span class="variable">password</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">salt</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">verifier</span><span class="operator">,</span> <span class="variable">gN</span><span class="operator">-&gt;</span>N<span class="operator">,</span> <span class="variable">gN</span><span class="operator">-&gt;</span>g<span class="operator">,</span>
                           <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
</pre>
<pre>
 <span class="variable">SRP_user_pwd</span> <span class="variable">*pwd</span> <span class="operator">=</span> <span class="variable">SRP_user_pwd_new</span><span class="operator">();</span>
 <span class="variable">SRP_user_pwd_set1_ids</span><span class="operator">(</span><span class="variable">pwd</span><span class="operator">,</span> <span class="variable">username</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
 <span class="variable">SRP_user_pwd_set0_sv</span><span class="operator">(</span><span class="variable">pwd</span><span class="operator">,</span> <span class="variable">salt</span><span class="operator">,</span> <span class="variable">verifier</span><span class="operator">);</span>
 <span class="variable">SRP_user_pwd_set_gN</span><span class="operator">(</span><span class="variable">pwd</span><span class="operator">,</span> <span class="variable">gN</span><span class="operator">-&gt;</span>g<span class="operator">,</span> <span class="variable">gN</span><span class="operator">-&gt;</span>N<span class="operator">);</span>
</pre>
<pre>
 <span class="variable">SRP_VBASE_add0_user</span><span class="operator">(</span><span class="variable">srpData</span><span class="operator">,</span> <span class="variable">pwd</span><span class="operator">);</span>
</pre>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><em>openssl-srp(1)</em>,
<em>SRP_VBASE_new(3)</em>,
<em>SRP_user_pwd_new(3)</em></p>
<p>
</p>
<hr />
<h1><a name="history">HISTORY</a></h1>
<p><code>SRP_create_verifier_BN_ex()</code> and <code>SRP_create_verifier_ex()</code> were introduced in
OpenSSL 3.0. All other functions were added in OpenSSL 1.0.1.</p>
<p>All of these functions were deprecated in OpenSSL 3.0.</p>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright 2018-2021 The OpenSSL Project Authors. All Rights Reserved.</p>
<p>Licensed under the Apache License 2.0 (the &quot;License&quot;).  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
<a href="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</a>.</p>

</body>

</html>
