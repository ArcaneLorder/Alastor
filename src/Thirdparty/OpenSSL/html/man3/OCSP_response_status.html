<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>OCSP_response_status</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#return_values">RETURN VALUES</a></li>
	<li><a href="#notes">NOTES</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#history">HISTORY</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>OCSP_response_status, OCSP_response_get1_basic, OCSP_response_create,
OCSP_RESPONSE_free, OCSP_RESPID_set_by_name,
OCSP_RESPID_set_by_key_ex, OCSP_RESPID_set_by_key, OCSP_RESPID_match_ex,
OCSP_RESPID_match, OCSP_basic_sign, OCSP_basic_sign_ctx
- OCSP response functions</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
 <span class="comment">#include &lt;openssl/ocsp.h&gt;</span>
</pre>
<pre>
 <span class="keyword">int</span> <span class="variable">OCSP_response_status</span><span class="operator">(</span><span class="variable">OCSP_RESPONSE</span> <span class="variable">*resp</span><span class="operator">);</span>
 <span class="variable">OCSP_BASICRESP</span> <span class="variable">*OCSP_response_get1_basic</span><span class="operator">(</span><span class="variable">OCSP_RESPONSE</span> <span class="variable">*resp</span><span class="operator">);</span>
 <span class="variable">OCSP_RESPONSE</span> <span class="variable">*OCSP_response_create</span><span class="operator">(</span><span class="keyword">int</span> <span class="variable">status</span><span class="operator">,</span> <span class="variable">OCSP_BASICRESP</span> <span class="variable">*bs</span><span class="operator">);</span>
 <span class="variable">void</span> <span class="variable">OCSP_RESPONSE_free</span><span class="operator">(</span><span class="variable">OCSP_RESPONSE</span> <span class="variable">*resp</span><span class="operator">);</span>
</pre>
<pre>
 <span class="keyword">int</span> <span class="variable">OCSP_RESPID_set_by_name</span><span class="operator">(</span><span class="variable">OCSP_RESPID</span> <span class="variable">*respid</span><span class="operator">,</span> <span class="variable">X509</span> <span class="variable">*cert</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OCSP_RESPID_set_by_key_ex</span><span class="operator">(</span><span class="variable">OCSP_RESPID</span> <span class="variable">*respid</span><span class="operator">,</span> <span class="variable">X509</span> <span class="variable">*cert</span><span class="operator">,</span>
                               <span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*propq</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OCSP_RESPID_set_by_key</span><span class="operator">(</span><span class="variable">OCSP_RESPID</span> <span class="variable">*respid</span><span class="operator">,</span> <span class="variable">X509</span> <span class="variable">*cert</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OCSP_RESPID_match_ex</span><span class="operator">(</span><span class="variable">OCSP_RESPID</span> <span class="variable">*respid</span><span class="operator">,</span> <span class="variable">X509</span> <span class="variable">*cert</span><span class="operator">,</span> <span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span>
                          <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*propq</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OCSP_RESPID_match</span><span class="operator">(</span><span class="variable">OCSP_RESPID</span> <span class="variable">*respid</span><span class="operator">,</span> <span class="variable">X509</span> <span class="variable">*cert</span><span class="operator">);</span>
</pre>
<pre>
 <span class="keyword">int</span> <span class="variable">OCSP_basic_sign</span><span class="operator">(</span><span class="variable">OCSP_BASICRESP</span> <span class="variable">*brsp</span><span class="operator">,</span> <span class="variable">X509</span> <span class="variable">*signer</span><span class="operator">,</span> <span class="variable">EVP_PKEY</span> <span class="variable">*key</span><span class="operator">,</span>
                     <span class="variable">const</span> <span class="variable">EVP_MD</span> <span class="variable">*dgst</span><span class="operator">,</span> <span class="variable">STACK_OF</span><span class="operator">(</span><span class="variable">X509</span><span class="operator">)</span> <span class="variable">*certs</span><span class="operator">,</span>
                     <span class="variable">unsigned</span> <span class="variable">long</span> <span class="variable">flags</span><span class="operator">);</span>
 <span class="keyword">int</span> <span class="variable">OCSP_basic_sign_ctx</span><span class="operator">(</span><span class="variable">OCSP_BASICRESP</span> <span class="variable">*brsp</span><span class="operator">,</span> <span class="variable">X509</span> <span class="variable">*signer</span><span class="operator">,</span> <span class="variable">EVP_MD_CTX</span> <span class="variable">*ctx</span><span class="operator">,</span>
                         <span class="variable">STACK_OF</span><span class="operator">(</span><span class="variable">X509</span><span class="operator">)</span> <span class="variable">*certs</span><span class="operator">,</span> <span class="variable">unsigned</span> <span class="variable">long</span> <span class="variable">flags</span><span class="operator">);</span>
</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p><code>OCSP_response_status()</code> returns the OCSP response status of <em>resp</em>. It returns
one of the values: <em>OCSP_RESPONSE_STATUS_SUCCESSFUL</em>,
<em>OCSP_RESPONSE_STATUS_MALFORMEDREQUEST</em>,
<em>OCSP_RESPONSE_STATUS_INTERNALERROR</em>, <em>OCSP_RESPONSE_STATUS_TRYLATER</em>
<em>OCSP_RESPONSE_STATUS_SIGREQUIRED</em>, or <em>OCSP_RESPONSE_STATUS_UNAUTHORIZED</em>.</p>
<p>OCSP_response_get1_basic() decodes and returns the <em>OCSP_BASICRESP</em> structure
contained in <em>resp</em>.</p>
<p><code>OCSP_response_create()</code> creates and returns an <em>OCSP_RESPONSE</em> structure for
<em>status</em> and optionally including basic response <em>bs</em>.</p>
<p><code>OCSP_RESPONSE_free()</code> frees up OCSP response <em>resp</em>.</p>
<p><code>OCSP_RESPID_set_by_name()</code> sets the name of the OCSP_RESPID to be the same as the
subject name in the supplied X509 certificate <em>cert</em> for the OCSP responder.</p>
<p><code>OCSP_RESPID_set_by_key_ex()</code> sets the key of the OCSP_RESPID to be the same as the
key in the supplied X509 certificate <em>cert</em> for the OCSP responder. The key is
stored as a SHA1 hash. To calculate the hash the SHA1 algorithm is fetched using
the library ctx <em>libctx</em> and the property query string <em>propq</em> (see
<em>crypto(7)/ALGORITHM FETCHING</em> for further information).</p>
<p><code>OCSP_RESPID_set_by_key()</code> does the same as <code>OCSP_RESPID_set_by_key_ex()</code> except
that the default library context is used with an empty property query string.</p>
<p>Note that an OCSP_RESPID can only have one of the name, or the key set. Calling
<code>OCSP_RESPID_set_by_name()</code> or <code>OCSP_RESPID_set_by_key()</code> will clear any existing
setting.</p>
<p><code>OCSP_RESPID_match_ex()</code> tests whether the OCSP_RESPID given in <em>respid</em> matches
with the X509 certificate <em>cert</em> based on the SHA1 hash. To calculate the hash
the SHA1 algorithm is fetched using the library ctx <em>libctx</em> and the property
query string <em>propq</em> (see <em>crypto(7)/ALGORITHM FETCHING</em> for further
information).</p>
<p><code>OCSP_RESPID_match()</code> does the same as <code>OCSP_RESPID_match_ex()</code> except that the
default library context is used with an empty property query string.</p>
<p><code>OCSP_basic_sign()</code> signs OCSP response <em>brsp</em> using certificate <em>signer</em>, private key
<em>key</em>, digest <em>dgst</em> and additional certificates <em>certs</em>. If the <em>flags</em> option
<em>OCSP_NOCERTS</em> is set then no certificates will be included in the response. If the
<em>flags</em> option <em>OCSP_RESPID_KEY</em> is set then the responder is identified by key ID
rather than by name. <code>OCSP_basic_sign_ctx()</code> also signs OCSP response <em>brsp</em> but
uses the parameters contained in digest context <em>ctx</em>.</p>
<p>
</p>
<hr />
<h1><a name="return_values">RETURN VALUES</a></h1>
<p><code>OCSP_RESPONSE_status()</code> returns a status value.</p>
<p>OCSP_response_get1_basic() returns an <em>OCSP_BASICRESP</em> structure pointer or
<em>NULL</em> if an error occurred.</p>
<p><code>OCSP_response_create()</code> returns an <em>OCSP_RESPONSE</em> structure pointer or <em>NULL</em>
if an error occurred.</p>
<p><code>OCSP_RESPONSE_free()</code> does not return a value.</p>
<p><code>OCSP_RESPID_set_by_name()</code>, <code>OCSP_RESPID_set_by_key()</code>, <code>OCSP_basic_sign()</code>, and
<code>OCSP_basic_sign_ctx()</code> return 1 on success or 0
on failure.</p>
<p><code>OCSP_RESPID_match()</code> returns 1 if the OCSP_RESPID and the X509 certificate match
or 0 otherwise.</p>
<p>
</p>
<hr />
<h1><a name="notes">NOTES</a></h1>
<p>OCSP_response_get1_basic() is only called if the status of a response is
<em>OCSP_RESPONSE_STATUS_SUCCESSFUL</em>.</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><em>crypto(7)</em>
<em>OCSP_cert_to_id(3)</em>
<em>OCSP_request_add1_nonce(3)</em>
<em>OCSP_REQUEST_new(3)</em>
<em>OCSP_resp_find_status(3)</em>
<em>OCSP_sendreq_new(3)</em>
<em>OCSP_RESPID_new(3)</em>
<em>OCSP_RESPID_free(3)</em></p>
<p>
</p>
<hr />
<h1><a name="history">HISTORY</a></h1>
<p>The <code>OCSP_RESPID_set_by_name()</code>, <code>OCSP_RESPID_set_by_key()</code> and <code>OCSP_RESPID_match()</code>
functions were added in OpenSSL 1.1.0a.</p>
<p>The <code>OCSP_basic_sign_ctx()</code> function was added in OpenSSL 1.1.1.</p>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright 2015-2021 The OpenSSL Project Authors. All Rights Reserved.</p>
<p>Licensed under the Apache License 2.0 (the &quot;License&quot;).  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
<a href="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</a>.</p>

</body>

</html>
