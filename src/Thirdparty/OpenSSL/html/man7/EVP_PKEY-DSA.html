<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>EVP_PKEY-DSA</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<ul>

		<li><a href="#dsa_parameters">DSA parameters</a></li>
		<li><a href="#dsa_key_generation_parameters">DSA key generation parameters</a></li>
		<li><a href="#dsa_key_validation">DSA key validation</a></li>
	</ul>

	<li><a href="#examples">EXAMPLES</a></li>
	<li><a href="#conforming_to">CONFORMING TO</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>EVP_PKEY-DSA, EVP_KEYMGMT-DSA - EVP_PKEY DSA keytype and algorithm support</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>For <strong>DSA</strong> the FIPS186-4 standard specifies that the values used for FFC
parameter generation are also required for parameter validation.
This means that optional FFC domain parameter values for <em>seed</em>, <em>pcounter</em>
and <em>gindex</em> may need to be stored for validation purposes. For <strong>DSA</strong> these
fields are not stored in the ASN1 data so they need to be stored externally if
validation is required.</p>
<p>
</p>
<h2><a name="dsa_parameters">DSA parameters</a></h2>
<p>The <strong>DSA</strong> key type supports the FFC parameters (see
<em>EVP_PKEY-FFC(7)/FFC parameters</em>).</p>
<p>
</p>
<h2><a name="dsa_key_generation_parameters">DSA key generation parameters</a></h2>
<p>The <strong>DSA</strong> key type supports the FFC key generation parameters (see
<em>EVP_PKEY-FFC(7)/FFC key generation parameters</em></p>
<p>The following restrictions apply to the &quot;pbits&quot; field:</p>
<p>For &quot;fips186_4&quot; this must be either 2048 or 3072.
For &quot;fips186_2&quot; this must be 1024.
For &quot;group&quot; this can be any one of 2048, 3072, 4096, 6144 or 8192.</p>
<p>
</p>
<h2><a name="dsa_key_validation">DSA key validation</a></h2>
<p>For DSA keys, <em>EVP_PKEY_param_check(3)</em> behaves in the following way:
The OpenSSL FIPS provider conforms to the rules within the FIPS186-4
standard for FFC parameter validation. For backwards compatibility the OpenSSL
default provider uses a much simpler check (see below) for parameter validation,
unless the seed parameter is set.</p>
<p>For DSA keys, <em>EVP_PKEY_param_check_quick(3)</em> behaves in the following way:
A simple check of L and N and partial g is performed. The default provider
also supports validation of legacy &quot;fips186_2&quot; keys.</p>
<p>For DSA keys, <em>EVP_PKEY_public_check(3)</em>, <em>EVP_PKEY_private_check(3)</em> and
<em>EVP_PKEY_pairwise_check(3)</em> the OpenSSL default and FIPS providers conform to
the rules within SP800-56Ar3 for public, private and pairwise tests respectively.</p>
<p>
</p>
<hr />
<h1><a name="examples">EXAMPLES</a></h1>
<p>An <strong>EVP_PKEY</strong> context can be obtained by calling:</p>
<pre>
    <span class="variable">EVP_PKEY_CTX</span> <span class="variable">*pctx</span> <span class="operator">=</span> <span class="variable">EVP_PKEY_CTX_new_from_name</span><span class="operator">(</span><span class="variable">NULL</span><span class="operator">,</span> <span class="string">"DSA"</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
</pre>
<p>The <strong>DSA</strong> domain parameters can be generated by calling:</p>
<pre>
    <span class="variable">unsigned</span> <span class="keyword">int</span> <span class="variable">pbits</span> <span class="operator">=</span> <span class="number">2048</span><span class="operator">;</span>
    <span class="variable">unsigned</span> <span class="keyword">int</span> <span class="variable">qbits</span> <span class="operator">=</span> <span class="number">256</span><span class="operator">;</span>
    <span class="keyword">int</span> <span class="variable">gindex</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span>
    <span class="variable">OSSL_PARAM</span> <span class="variable">params</span><span class="operator">[</span><span class="number">5</span><span class="operator">]</span><span class="operator">;</span>
    <span class="variable">EVP_PKEY</span> <span class="variable">*param_key</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    <span class="variable">EVP_PKEY_CTX</span> <span class="variable">*pctx</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
</pre>
<pre>
    <span class="variable">pctx</span> <span class="operator">=</span> <span class="variable">EVP_PKEY_CTX_new_from_name</span><span class="operator">(</span><span class="variable">NULL</span><span class="operator">,</span> <span class="string">"DSA"</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_paramgen_init</span><span class="operator">(</span><span class="variable">pctx</span><span class="operator">);</span>
</pre>
<pre>
    <span class="variable">params</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_uint</span><span class="operator">(</span><span class="string">"pbits"</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">pbits</span><span class="operator">);</span>
    <span class="variable">params</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_uint</span><span class="operator">(</span><span class="string">"qbits"</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">qbits</span><span class="operator">);</span>
    <span class="variable">params</span><span class="operator">[</span><span class="number">2</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_int</span><span class="operator">(</span><span class="string">"gindex"</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">gindex</span><span class="operator">);</span>
    <span class="variable">params</span><span class="operator">[</span><span class="number">3</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_utf8_string</span><span class="operator">(</span><span class="string">"digest"</span><span class="operator">,</span> <span class="string">"SHA384"</span><span class="operator">,</span> <span class="number">0</span><span class="operator">);</span>
    <span class="variable">params</span><span class="operator">[</span><span class="number">4</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_end</span><span class="operator">();</span>
    <span class="variable">EVP_PKEY_CTX_set_params</span><span class="operator">(</span><span class="variable">pctx</span><span class="operator">,</span> <span class="variable">params</span><span class="operator">);</span>
</pre>
<pre>
    <span class="variable">EVP_PKEY_generate</span><span class="operator">(</span><span class="variable">pctx</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">param_key</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_CTX_free</span><span class="operator">(</span><span class="variable">pctx</span><span class="operator">);</span>
</pre>
<pre>
    <span class="variable">EVP_PKEY_print_params</span><span class="operator">(</span><span class="variable">bio_out</span><span class="operator">,</span> <span class="variable">param_key</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
</pre>
<p>A <strong>DSA</strong> key can be generated using domain parameters by calling:</p>
<pre>
    <span class="variable">EVP_PKEY</span> <span class="variable">*key</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    <span class="variable">EVP_PKEY_CTX</span> <span class="variable">*gctx</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
</pre>
<pre>
    <span class="variable">gctx</span> <span class="operator">=</span> <span class="variable">EVP_PKEY_CTX_new_from_pkey</span><span class="operator">(</span><span class="variable">NULL</span><span class="operator">,</span> <span class="variable">param_key</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_keygen_init</span><span class="operator">(</span><span class="variable">gctx</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_generate</span><span class="operator">(</span><span class="variable">gctx</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">key</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_CTX_free</span><span class="operator">(</span><span class="variable">gctx</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_print_private</span><span class="operator">(</span><span class="variable">bio_out</span><span class="operator">,</span> <span class="variable">key</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
</pre>
<p>
</p>
<hr />
<h1><a name="conforming_to">CONFORMING TO</a></h1>
<p>The following sections of FIPS186-4:</p>
<dl>
<dt><strong><a name="a_1_1_2_generation_of_probable_primes_p_and_q_using_an_approved_hash_function" class="item">A.1.1.2 Generation of Probable Primes p and q Using an Approved Hash Function.</a></strong></dt>

<dt><strong><a name="a_2_3_generation_of_canonical_generator_g" class="item">A.2.3 Generation of canonical generator g.</a></strong></dt>

<dt><strong><a name="a_2_1_unverifiable_generation_of_the_generator_g" class="item">A.2.1 Unverifiable Generation of the Generator g.</a></strong></dt>

</dl>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><em>EVP_PKEY-FFC(7)</em>,
<em>EVP_SIGNATURE-DSA(7)</em>
<em>EVP_PKEY(3)</em>,
<em>provider-keymgmt(7)</em>,
<em>EVP_KEYMGMT(3)</em>,
<em>OSSL_PROVIDER-default(7)</em>,
<em>OSSL_PROVIDER-FIPS(7)</em></p>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright 2020-2022 The OpenSSL Project Authors. All Rights Reserved.</p>
<p>Licensed under the Apache License 2.0 (the &quot;License&quot;).  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
<a href="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</a>.</p>

</body>

</html>
